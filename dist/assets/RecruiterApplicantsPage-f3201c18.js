import{f as E,r as c,m as ee,j as e,P as I,n as te,o as R,R as M,k as U,b as v,B as ae,u as se,e as re,p as ne,s as A,a as q}from"./index-83d3308d.js";import{C as ie,a as le,b as oe,d as ce,e as de}from"./card-50842a49.js";import{m as C}from"./motion-d59b358d.js";import{F as ue}from"./file-text-7c1dfec9.js";import{L as w}from"./loader-2-9b3534bc.js";import{E as me}from"./eye-56b6a311.js";import"./input-5b7e13be.js";import{F as xe}from"./filter-969e3e59.js";import{U as $}from"./users-c5d49dfc.js";import{A as P}from"./arrow-left-2595241a.js";const he=E("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),fe=E("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),pe=E("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),ve=E("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);var D={exports:{}},H={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b=c;function ge(t,a){return t===a&&(t!==0||1/t===1/a)||t!==t&&a!==a}var ye=typeof Object.is=="function"?Object.is:ge,be=b.useState,je=b.useEffect,we=b.useLayoutEffect,Ne=b.useDebugValue;function ke(t,a){var r=a(),n=be({inst:{value:r,getSnapshot:a}}),i=n[0].inst,s=n[1];return we(function(){i.value=r,i.getSnapshot=a,L(i)&&s({inst:i})},[t,r,a]),je(function(){return L(i)&&s({inst:i}),t(function(){L(i)&&s({inst:i})})},[t]),Ne(r),r}function L(t){var a=t.getSnapshot;t=t.value;try{var r=a();return!ye(t,r)}catch{return!0}}function Se(t,a){return a()}var Ae=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?Se:ke;H.useSyncExternalStore=b.useSyncExternalStore!==void 0?b.useSyncExternalStore:Ae;D.exports=H;var Ce=D.exports;function Ee(){return Ce.useSyncExternalStore(_e,()=>!0,()=>!1)}function _e(){return()=>{}}var F="Avatar",[Le,Ge]=ee(F),[Re,T]=Le(F),J=c.forwardRef((t,a)=>{const{__scopeAvatar:r,...n}=t,[i,s]=c.useState("idle");return e.jsx(Re,{scope:r,imageLoadingStatus:i,onImageLoadingStatusChange:s,children:e.jsx(I.span,{...n,ref:a})})});J.displayName=F;var B="AvatarImage",V=c.forwardRef((t,a)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:i=()=>{},...s}=t,x=T(B,r),o=Ie(n,s),d=te(u=>{i(u),x.onImageLoadingStatusChange(u)});return R(()=>{o!=="idle"&&d(o)},[o,d]),o==="loaded"?e.jsx(I.img,{...s,ref:a,src:n}):null});V.displayName=B;var G="AvatarFallback",X=c.forwardRef((t,a)=>{const{__scopeAvatar:r,delayMs:n,...i}=t,s=T(G,r),[x,o]=c.useState(n===void 0);return c.useEffect(()=>{if(n!==void 0){const d=window.setTimeout(()=>o(!0),n);return()=>window.clearTimeout(d)}},[n]),x&&s.imageLoadingStatus!=="loaded"?e.jsx(I.span,{...i,ref:a}):null});X.displayName=G;function z(t,a){return t?a?(t.src!==a&&(t.src=a),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function Ie(t,{referrerPolicy:a,crossOrigin:r}){const n=Ee(),i=c.useRef(null),s=(()=>n?(i.current||(i.current=new window.Image),i.current):null)(),[x,o]=c.useState(()=>z(s,t));return R(()=>{o(z(s,t))},[s,t]),R(()=>{const d=f=>()=>{o(f)};if(!s)return;const u=d("loaded"),h=d("error");return s.addEventListener("load",u),s.addEventListener("error",h),a&&(s.referrerPolicy=a),typeof r=="string"&&(s.crossOrigin=r),()=>{s.removeEventListener("load",u),s.removeEventListener("error",h)}},[s,r,a]),x}var K=J,O=V,W=X;const Q=M.forwardRef(({className:t,...a},r)=>e.jsx(K,{ref:r,className:U("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...a}));Q.displayName=K.displayName;const Y=M.forwardRef(({className:t,...a},r)=>e.jsx(O,{ref:r,className:U("aspect-square h-full w-full",t),...a}));Y.displayName=O.displayName;const Z=M.forwardRef(({className:t,...a},r)=>e.jsx(W,{ref:r,className:U("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...a}));Z.displayName=W.displayName;const Me=({applicant:t,index:a,statusColors:r,getResumeUrl:n,updateApplicationStatus:i,actionLoading:s})=>{var d,u,h,f,p,N,j,k,S;const x=r[t.status]||r.default,o=l=>{s||i(t.id,l)};return e.jsx(C.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.4,delay:a*.05},children:e.jsxs(ie,{className:"bg-gray-800/70 backdrop-blur-sm border-gray-700 hover:border-cyan-600/70 transition-colors duration-300 shadow-lg",children:[e.jsxs(le,{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3 sm:mb-0",children:[e.jsxs(Q,{children:[e.jsx(Y,{src:((d=t.candidate)==null?void 0:d.avatar_url)||void 0,alt:(u=t.candidate)==null?void 0:u.full_name}),e.jsx(Z,{children:((f=(h=t.candidate)==null?void 0:h.full_name)==null?void 0:f.substring(0,2).toUpperCase())||"N/A"})]}),e.jsxs("div",{children:[e.jsx(oe,{className:"text-lg text-cyan-300",children:((p=t.candidate)==null?void 0:p.full_name)||"N/A"}),e.jsxs("a",{href:`mailto:${(N=t.candidate)==null?void 0:N.email}`,className:"text-xs text-teal-400 hover:underline flex items-center",children:[e.jsx(fe,{className:"w-3 h-3 mr-1"}),((j=t.candidate)==null?void 0:j.email)||"No email"]})]})]}),e.jsx("span",{className:`px-3 py-1 text-xs font-semibold rounded-full ${x}`,children:t.status||"Unknown"})]}),e.jsxs(ce,{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-gray-400",children:["Applied: ",new Date(t.applied_at).toLocaleDateString()]}),((k=t.resume)==null?void 0:k.storage_path)&&e.jsx("a",{href:n(t.resume.storage_path),target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center",children:e.jsxs(v,{variant:"outline",size:"sm",className:"border-sky-500 text-sky-300 hover:bg-sky-500 hover:text-white",children:[e.jsx(he,{className:"mr-1.5 h-4 w-4"})," ",t.resume.file_name||"View Resume"]})}),!((S=t.resume)!=null&&S.storage_path)&&e.jsxs("p",{className:"text-sm text-yellow-400 flex items-center",children:[e.jsx(ue,{className:"mr-1.5 h-4 w-4"}),"No resume uploaded."]}),t.cover_letter&&e.jsxs("details",{className:"text-sm text-gray-300",children:[e.jsx("summary",{className:"cursor-pointer hover:text-cyan-300",children:"View Cover Letter"}),e.jsx("p",{className:"mt-2 p-3 bg-gray-700/50 rounded-md whitespace-pre-line",children:t.cover_letter})]})]}),e.jsxs(de,{className:"flex flex-wrap gap-2 pt-4 border-t border-gray-700/50",children:[e.jsxs(v,{onClick:()=>o("reviewing"),disabled:s,variant:"outline",size:"sm",className:"border-yellow-500 text-yellow-300 hover:bg-yellow-500 hover:text-white",children:[s?e.jsx(w,{className:"mr-1.5 h-4 w-4 animate-spin"}):e.jsx(me,{className:"mr-1.5 h-4 w-4"})," Mark Reviewing"]}),e.jsxs(v,{onClick:()=>o("interviewing"),disabled:s,variant:"outline",size:"sm",className:"border-blue-500 text-blue-300 hover:bg-blue-500 hover:text-white",children:[s?e.jsx(w,{className:"mr-1.5 h-4 w-4 animate-spin"}):e.jsx(pe,{className:"mr-1.5 h-4 w-4"})," Mark Interviewing"]}),e.jsxs(v,{onClick:()=>o("hired"),disabled:s,variant:"outline",size:"sm",className:"border-green-500 text-green-300 hover:bg-green-500 hover:text-white",children:[s?e.jsx(w,{className:"mr-1.5 h-4 w-4 animate-spin"}):e.jsx(ae,{className:"mr-1.5 h-4 w-4"})," Mark Hired"]}),e.jsxs(v,{onClick:()=>o("rejected"),disabled:s,variant:"outline",size:"sm",className:"border-red-500 text-red-300 hover:bg-red-500 hover:text-white",children:[s?e.jsx(w,{className:"mr-1.5 h-4 w-4 animate-spin"}):e.jsx(ve,{className:"mr-1.5 h-4 w-4"})," Mark Rejected"]})]})]})})},Ue=({filters:t,setFilters:a})=>{const r=n=>{a(i=>({...i,status:n.target.value}))};return e.jsxs(C.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"mb-8 p-6 bg-gray-800/50 backdrop-blur-md rounded-xl shadow-xl",children:[e.jsxs("h2",{className:"text-xl font-semibold text-cyan-200 mb-4 flex items-center",children:[e.jsx(xe,{className:"mr-2 h-5 w-5"}),"Filter Applicants"]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:e.jsxs("select",{value:t.status,onChange:r,className:"p-2.5 rounded-md bg-gray-700 border-gray-600 focus:border-cyan-500 focus:ring-cyan-500 text-white",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"applied",children:"Applied"}),e.jsx("option",{value:"reviewing",children:"Reviewing"}),e.jsx("option",{value:"interviewing",children:"Interviewing"}),e.jsx("option",{value:"rejected",children:"Rejected"}),e.jsx("option",{value:"hired",children:"Hired"})]})})]})},Fe={applied:"bg-blue-700 text-blue-200",reviewing:"bg-yellow-700 text-yellow-200",interviewing:"bg-purple-700 text-purple-200",hired:"bg-green-700 text-green-200",rejected:"bg-red-700 text-red-200",default:"bg-gray-700 text-gray-300"},Xe=()=>{const{user:t}=se(),{toast:a}=re(),[r]=ne(),n=r.get("jobId"),[i,s]=c.useState([]),[x,o]=c.useState(""),[d,u]=c.useState(!0),[h,f]=c.useState(null),[p,N]=c.useState({status:""}),j=c.useCallback(async()=>{if(!t||!n){u(!1);return}u(!0);try{const{data:l,error:m}=await A.from("jobs").select("title").eq("id",n).eq("recruiter_id",t.id).single();if(m||!l){a({title:"Error",description:(m==null?void 0:m.message)||"Could not fetch job details or access denied.",variant:"destructive"}),o("Unknown Job"),s([]),u(!1);return}o(l.title);let g=A.from("applications").select(`
          id, 
          applied_at, 
          status, 
          cover_letter,
          candidate:profiles (id, full_name, email, avatar_url),
          resume:resumes (id, file_name, storage_path)
        `).eq("job_id",n).order("applied_at",{ascending:!1});p.status&&(g=g.eq("status",p.status));const{data:_,error:y}=await g;if(y)throw y;s(_||[])}catch(l){console.error("Error fetching applicants:",l),a({title:"Error Fetching Applicants",description:l.message,variant:"destructive"}),s([])}finally{u(!1)}},[t,n,a,p]);c.useEffect(()=>{j()},[j]);const k=async(l,m)=>{f(l);const{error:g}=await A.from("applications").update({status:m}).eq("id",l);f(null),g?a({title:"Update Failed",description:g.message,variant:"destructive"}):(a({title:"Status Updated",description:`Application status changed to ${m}.`}),s(_=>_.map(y=>y.id===l?{...y,status:m}:y)))},S=l=>{if(!l)return null;const{data:m}=A.storage.from("resumes").getPublicUrl(l);return m.publicUrl};return d&&i.length===0&&n?e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-teal-800 via-cyan-900 to-sky-900 text-white",children:[e.jsx(w,{className:"h-12 w-12 animate-spin text-cyan-300 mr-3"})," Loading applicants for ",x||"job","..."]}):n?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-teal-800 via-cyan-900 to-sky-900 text-white p-6",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsxs(C.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:[e.jsx(q,{to:"/recruiter/jobs",children:e.jsxs(v,{variant:"ghost",className:"text-cyan-300 hover:bg-cyan-700/30 hover:text-cyan-100 mb-2",children:[e.jsx(P,{className:"mr-2 h-5 w-5"})," Back to Manage Jobs"]})}),e.jsxs("h1",{className:"text-4xl font-bold text-cyan-300",children:["Applicants for: ",e.jsx("span",{className:"text-teal-300",children:x})]}),e.jsx("p",{className:"text-lg text-gray-300",children:"Review and manage candidates who applied for this role."})]}),e.jsx(Ue,{filters:p,setFilters:N}),i.length===0&&!d?e.jsxs(C.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.2},className:"text-center py-16 bg-gray-800/50 backdrop-blur-sm rounded-xl shadow-xl",children:[e.jsx($,{className:"mx-auto h-24 w-24 text-gray-500 mb-6"}),e.jsx("p",{className:"text-2xl text-gray-300 mb-4",children:"No applicants match your current filters, or no one has applied yet."}),e.jsx("p",{className:"text-gray-400",children:"Check back later or adjust your filters."})]}):e.jsx("div",{className:"space-y-6",children:i.map((l,m)=>e.jsx(Me,{applicant:l,index:m,statusColors:Fe,getResumeUrl:S,updateApplicationStatus:k,actionLoading:h===l.id},l.id))})]})}):e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-red-800 via-red-900 to-pink-900 text-white p-6",children:[e.jsx($,{className:"w-24 h-24 text-red-300 mb-6"}),e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"No Job Selected"}),e.jsx("p",{className:"text-lg text-red-200 mb-6",children:"Please select a job from the 'Manage Jobs' page to view applicants."}),e.jsx(q,{to:"/recruiter/jobs",children:e.jsxs(v,{variant:"outline",size:"lg",className:"border-red-300 text-red-200 hover:bg-red-300 hover:text-black",children:[e.jsx(P,{className:"mr-2 h-5 w-5"})," Go to Manage Jobs"]})})]})};export{Xe as default};
