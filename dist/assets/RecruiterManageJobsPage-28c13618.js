import{f as b,u as L,e as E,r as n,s as g,j as e,a as h,b as r,B as u,R as J}from"./index-8ded0fa8.js";import{C as T,a as D,b as M,c as q,d as P,e as S}from"./card-5e5ef74a.js";import{L as f}from"./loader-2-31b54a6b.js";import{m as v}from"./motion-b0a52920.js";import{A as $}from"./arrow-left-34b93e51.js";import{U as k}from"./users-dbf5baf9.js";import{A as z}from"./alert-triangle-1885b9fb.js";import{E as F}from"./eye-4f602c4a.js";import{T as R}from"./trash-2-b9a4b4bc.js";const B=b("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),O=b("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),U=b("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),X=()=>{const{user:l}=L(),{toast:a}=E(),[c,o]=n.useState([]),[j,p]=n.useState(!0),[d,m]=n.useState(null),N=n.useCallback(async()=>{if(!l){p(!1);return}p(!0);const{data:s,error:t}=await g.from("jobs").select("id, title, company, location, posted_at, is_active, job_type, skills_required, experience_level, (SELECT COUNT(*) FROM applications WHERE applications.job_id = jobs.id) as applicant_count").eq("recruiter_id",l.id).order("posted_at",{ascending:!1});t?(a({title:"Error Fetching Jobs",description:t.message,variant:"destructive"}),o([])):o(s||[]),p(!1)},[l,a]);n.useEffect(()=>{N()},[N]);const _=async s=>{if(!window.confirm("Are you sure you want to delete this job listing? This action also deletes all associated applications and cannot be undone."))return;m(s);const{error:t}=await g.from("jobs").delete().eq("id",s);m(null),t?a({title:"Failed to Delete Job",description:t.message,variant:"destructive"}):(a({title:"Job Deleted",description:"The job listing has been successfully deleted."}),o(i=>i.filter(x=>x.id!==s)))},A=async(s,t)=>{m(s);const{data:i,error:x}=await g.from("jobs").update({is_active:!t}).eq("id",s).select("is_active").single();m(null),x?a({title:"Failed to Update Status",description:x.message,variant:"destructive"}):i&&(a({title:`Job ${i.is_active?"Activated":"Deactivated"}`,description:"The job listing status has been updated."}),o(C=>C.map(y=>y.id===s?{...y,is_active:i.is_active}:y)))};return j&&c.length===0?e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-teal-800 via-cyan-900 to-sky-900 text-white",children:[e.jsx(f,{className:"h-12 w-12 animate-spin text-cyan-300 mr-3"})," Loading your job listings..."]}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-teal-800 via-cyan-900 to-sky-900 text-white p-6",children:e.jsxs("div",{className:"container mx-auto",children:[e.jsxs(v.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx(h,{to:"/recruiter/dashboard",children:e.jsxs(r,{variant:"ghost",className:"text-cyan-300 hover:bg-cyan-700/30 hover:text-cyan-100 mb-2 sm:mb-0",children:[e.jsx($,{className:"mr-2 h-5 w-5"})," Back to Dashboard"]})}),e.jsx("h1",{className:"text-4xl font-bold text-cyan-300",children:"Manage Your Job Listings"}),e.jsx("p",{className:"text-lg text-gray-300",children:"View, edit, or delete your posted jobs."})]}),e.jsx(h,{to:"/recruiter/jobs/new",children:e.jsxs(r,{size:"lg",className:"bg-gradient-to-r from-cyan-500 to-teal-600 hover:from-cyan-600 hover:to-teal-700 transform hover:scale-105 transition-all duration-300",children:[e.jsx(U,{className:"mr-2 h-5 w-5"})," Post New Job"]})})]}),c.length===0&&!j?e.jsxs(v.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5,delay:.2},className:"text-center py-16 bg-gray-800/50 backdrop-blur-sm rounded-xl shadow-xl",children:[e.jsx(u,{className:"mx-auto h-24 w-24 text-gray-500 mb-6"}),e.jsx("p",{className:"text-2xl text-gray-300 mb-4",children:"You haven't posted any jobs yet."}),e.jsx("p",{className:"text-gray-400 mb-6",children:"Start by creating a new job listing to attract talent."}),e.jsx(h,{to:"/recruiter/jobs/new",children:e.jsx(r,{size:"lg",className:"bg-gradient-to-r from-cyan-500 to-teal-600 hover:from-cyan-600 hover:to-teal-700",children:"Post Your First Job"})})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map((s,t)=>e.jsx(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:t*.05},children:e.jsxs(T,{className:`bg-gray-800/70 backdrop-blur-sm border-gray-700 hover:border-cyan-600/70 transition-all duration-300 shadow-lg flex flex-col h-full ${s.is_active?"":"opacity-70"}`,children:[e.jsxs(D,{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx(M,{className:"text-xl text-cyan-300 line-clamp-2",children:s.title}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full whitespace-nowrap ${s.is_active?"bg-green-500/20 text-green-300":"bg-yellow-500/20 text-yellow-300"}`,children:s.is_active?"Active":"Inactive"})]}),e.jsxs(q,{className:"text-sm text-teal-300",children:[s.company," - ",s.location]})]}),e.jsxs(P,{className:"space-y-3 flex-grow",children:[e.jsx(w,{icon:e.jsx(k,{className:"h-4 w-4"}),text:`${s.applicant_count||0} Applicants`,color:"text-sky-300"}),e.jsx(w,{icon:e.jsx(u,{className:"h-4 w-4"}),text:s.job_type||"N/A",color:"text-gray-300"}),e.jsx(w,{icon:e.jsx(u,{className:"h-4 w-4"}),text:s.experience_level||"N/A",color:"text-gray-300"}),s.skills_required&&s.skills_required.length>0&&e.jsxs("div",{className:"mt-1",children:[e.jsx("p",{className:"text-xs text-gray-400 mb-1",children:"Skills:"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[s.skills_required.slice(0,3).map(i=>e.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-gray-700 text-gray-300 rounded-md",children:i},i)),s.skills_required.length>3&&e.jsx("span",{className:"text-xs text-gray-400 self-end",children:"..."})]})]}),e.jsxs("p",{className:"text-xs text-gray-400 pt-2",children:["Posted: ",new Date(s.posted_at).toLocaleDateString()]}),!s.is_active&&e.jsxs("div",{className:"flex items-center text-xs text-yellow-400 p-2 bg-yellow-500/10 rounded-md mt-2",children:[e.jsx(z,{className:"h-4 w-4 mr-1.5 flex-shrink-0"})," This job is currently inactive."]})]}),e.jsxs(S,{className:"grid grid-cols-2 gap-2 pt-4 border-t border-gray-700/50",children:[e.jsx(h,{to:`/recruiter/applicants?jobId=${s.id}`,children:e.jsxs(r,{variant:"outline",size:"sm",className:"w-full border-sky-500 text-sky-300 hover:bg-sky-500 hover:text-white",children:[e.jsx(k,{className:"mr-1.5 h-4 w-4"})," Applicants"]})}),e.jsxs(r,{variant:"outline",size:"sm",disabled:!0,className:"w-full border-gray-600 text-gray-400 cursor-not-allowed",children:[e.jsx(O,{className:"mr-1.5 h-4 w-4"})," Edit"]}),e.jsxs(r,{onClick:()=>A(s.id,s.is_active),variant:"outline",size:"sm",disabled:d===s.id,className:`w-full ${s.is_active?"border-yellow-500 text-yellow-300 hover:bg-yellow-500":"border-green-500 text-green-300 hover:bg-green-500"} hover:text-white`,children:[d===s.id?e.jsx(f,{className:"mr-1.5 h-4 w-4 animate-spin"}):s.is_active?e.jsx(B,{className:"mr-1.5 h-4 w-4"}):e.jsx(F,{className:"mr-1.5 h-4 w-4"}),s.is_active?"Deactivate":"Activate"]}),e.jsxs(r,{onClick:()=>_(s.id),variant:"destructive",size:"sm",disabled:d===s.id,className:"w-full bg-red-700/50 hover:bg-red-600 text-red-300 border-red-600",children:[d===s.id?e.jsx(f,{className:"mr-1.5 h-4 w-4 animate-spin"}):e.jsx(R,{className:"mr-1.5 h-4 w-4"}),"Delete"]})]})]})},s.id))})]})})},w=({icon:l,text:a,color:c})=>e.jsxs("div",{className:`flex items-center text-xs ${c||"text-gray-300"}`,children:[J.cloneElement(l,{className:`mr-1.5 flex-shrink-0 ${l.props.className}`})," ",a]});export{X as default};
